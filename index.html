<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>BTC äº¤æ˜“çœ‹æ¿ (Proç‰ˆ)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* é¡µé¢åŸºç¡€æ ·å¼ */
        body { background-color: #0f172a; color: #e2e8f0; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; }
        
        /* å¡ç‰‡é€šç”¨æ ·å¼ */
        .card { 
            background-color: #1e293b; 
            border: 1px solid #334155; 
            border-radius: 16px; 
            padding: 24px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* æ–‡å­—æ ·å¼ */
        .label { color: #94a3b8; font-size: 0.875rem; margin-bottom: 8px; font-weight: 500; }
        .value { font-size: 2.5rem; font-weight: 800; line-height: 1; }
        .sub-text { font-size: 0.75rem; color: #64748b; margin-top: 8px; font-family: monospace; }
        
        /* çŠ¶æ€èƒ¶å›Š */
        .badge {
            margin-top: 12px;
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 700;
            display: inline-block;
        }

        /* é¢œè‰²å®šä¹‰ */
        .text-green { color: #4ade80; }
        .bg-green { background-color: rgba(74, 222, 128, 0.15); color: #4ade80; }
        
        .text-red { color: #f87171; }
        .bg-red { background-color: rgba(248, 113, 113, 0.15); color: #f87171; }
        
        .text-yellow { color: #facc15; }
        .bg-yellow { background-color: rgba(250, 204, 21, 0.15); color: #facc15; }

        .text-blue { color: #60a5fa; }
        .bg-blue { background-color: rgba(96, 165, 250, 0.15); color: #60a5fa; }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex flex-col items-center">

    <div class="w-full max-w-5xl">
        <div class="text-center mb-10">
            <h1 class="text-3xl font-black tracking-widest text-white uppercase">Market Monitor</h1>
            <p class="text-xs text-gray-500 mt-2">Data Refresh: 60s | Status: <span id="status-dot" class="text-green-500">â— Live</span></p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
            
            <div class="card">
                <div class="label">BTC å®æ—¶ä»·æ ¼</div>
                <div id="btc-price" class="value text-white">Loading...</div>
                <div class="sub-text">Binance Direct Feed</div>
            </div>

            <div class="card relative overflow-hidden">
                <div class="label">ææƒ§ & è´ªå©ªæŒ‡æ•°</div>
                <div id="fng-val" class="value">--</div>
                <div id="fng-badge" class="badge bg-gray-700 text-gray-300">è·å–ä¸­...</div>
                <div class="absolute bottom-0 left-0 h-1 bg-gray-700 w-full">
                    <div id="fng-bar" class="h-full transition-all duration-1000" style="width: 0%"></div>
                </div>
            </div>

            <div class="card">
                <div class="label">è·ç¦»ä¸‹ä¸€æ¬¡å‡åŠ</div>
                <div id="halving" class="value text-blue">--</div>
                <div class="sub-text">é¢„è®¡ 2028-04</div>
            </div>
        </div>

        <div class="mb-6">
            <div class="card w-full py-10 border-blue-500/30 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-blue-500 to-transparent opacity-50"></div>
                
                <div class="label text-lg mb-2">ahr999 å›¤å¸æŒ‡æ ‡</div>
                <div id="ahr-val" class="text-6xl font-black text-white mb-2 tracking-tighter">--</div>
                <div id="ahr-badge" class="text-xl font-bold px-6 py-2 rounded-full bg-gray-800 text-gray-400 border border-gray-700">
                    æ­£åœ¨è®¡ç®—é“¾ä¸Šæ•°æ®...
                </div>
                
                <div class="grid grid-cols-3 gap-2 mt-8 text-center text-xs text-gray-500 max-w-md w-full">
                    <div class="p-2 rounded bg-green/5 border border-green/10">
                        <span class="block text-green font-bold text-lg">< 0.45</span>
                        <span>æŠ„åº•åŒºé—´</span>
                    </div>
                    <div class="p-2 rounded bg-blue/5 border border-blue/10">
                        <span class="block text-blue font-bold text-lg">0.45 - 1.2</span>
                        <span>å®šæŠ•åŒºé—´</span>
                    </div>
                    <div class="p-2 rounded bg-red/5 border border-red/10">
                        <span class="block text-red font-bold text-lg">> 1.2</span>
                        <span>ç­‰å¾…è§‚æœ›</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="card py-6">
                <div class="label">MA 120 (ç‰›ç†Šçº¿)</div>
                <div id="ma120" class="text-xl font-bold text-gray-300">--</div>
            </div>
            <div class="card py-6">
                <div class="label">MA 200 (é•¿æœŸæˆæœ¬)</div>
                <div id="ma200" class="text-xl font-bold text-gray-300">--</div>
            </div>
            <div class="card py-6">
                <div class="label">RSI (14)</div>
                <div id="rsi" class="text-xl font-bold">--</div>
            </div>
            <div class="card py-6">
                <div class="label">ä»Šæ—¥æ¶¨è·Œå¹…</div>
                <div id="price-change" class="text-xl font-bold">--</div>
            </div>
        </div>

        <div class="text-center mt-12 text-gray-600 text-xs">
            Private Dashboard | Updates Automatically
        </div>
    </div>

    <script>
        // === 1. è·å– ææƒ§è´ªå©ªæŒ‡æ•° (åŒé€šé“ä¿éšœ) ===
        async function fetchFnG() {
            const fngValEl = document.getElementById('fng-val');
            const fngBadgeEl = document.getElementById('fng-badge');
            const fngBarEl = document.getElementById('fng-bar');

            try {
                // ä¼˜å…ˆé€šé“ï¼šç›´è¿å®˜æ–¹API
                let response = await fetch('https://api.alternative.me/fng/?limit=1');
                
                // å¤‡ç”¨é€šé“ï¼šå¦‚æœç›´è¿å¤±è´¥ï¼Œèµ°å…¬å…±ä»£ç†
                if (!response.ok) {
                    console.log("ç›´è¿å¤±è´¥ï¼Œåˆ‡æ¢ä»£ç†...");
                    response = await fetch('https://api.allorigins.win/raw?url=https://api.alternative.me/fng/');
                }

                const data = await response.json();
                const val = parseInt(data.data[0].value);
                const statusText = data.data[0].value_classification;

                // æ›´æ–°æ•°å€¼
                fngValEl.innerText = val;
                
                // æ›´æ–°æ ·å¼å’Œæ–‡å­—
                let colorClass = "";
                let bgClass = "";
                
                if (val <= 25) { // æåº¦ææƒ§
                    colorClass = "text-green"; // æœºä¼šæ¥äº†ç”¨ç»¿è‰²
                    bgClass = "bg-green";
                    fngBarEl.style.backgroundColor = "#4ade80";
                } else if (val <= 45) { // ææƒ§
                    colorClass = "text-blue";
                    bgClass = "bg-blue";
                    fngBarEl.style.backgroundColor = "#60a5fa";
                } else if (val <= 75) { // è´ªå©ª
                    colorClass = "text-yellow";
                    bgClass = "bg-yellow";
                    fngBarEl.style.backgroundColor = "#facc15";
                } else { // æåº¦è´ªå©ª
                    colorClass = "text-red"; // é£é™©æ¥äº†ç”¨çº¢è‰²
                    bgClass = "bg-red";
                    fngBarEl.style.backgroundColor = "#f87171";
                }

                fngValEl.className = `value ${colorClass}`;
                fngBadgeEl.className = `badge ${bgClass}`;
                fngBadgeEl.innerText = statusText; // ä¾‹å¦‚ "Extreme Fear"
                fngBarEl.style.width = val + "%";

            } catch (e) {
                console.error(e);
                fngValEl.innerText = "Err";
                fngBadgeEl.innerText = "ç½‘ç»œè¶…æ—¶";
            }
        }

        // === 2. è·å– BTC ä»·æ ¼ä¸è®¡ç®—æ ¸å¿ƒæŒ‡æ ‡ ===
        async function fetchMarket() {
            try {
                // ç›´è¿å¸å®‰ API
                const res = await fetch("https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1d&limit=200");
                const data = await res.json();
                
                const prices = data.map(k => parseFloat(k[4]));
                const currentPrice = prices[prices.length - 1];
                const openPrice = parseFloat(data[data.length - 1][1]); // ä»Šæ—¥å¼€ç›˜ä»·

                // 2.1 æ›´æ–°ä»·æ ¼
                document.getElementById('btc-price').innerText = `$${Math.floor(currentPrice).toLocaleString()}`;
                
                // 2.2 æ›´æ–°æ¶¨è·Œå¹…
                const change = ((currentPrice - openPrice) / openPrice) * 100;
                const changeEl = document.getElementById('price-change');
                changeEl.innerText = (change >= 0 ? "+" : "") + change.toFixed(2) + "%";
                changeEl.className = `text-xl font-bold ${change >= 0 ? "text-green" : "text-red"}`;

                // 2.3 è®¡ç®—å‡çº¿
                const ma120 = prices.slice(-120).reduce((a,b)=>a+b)/120;
                const ma200 = prices.reduce((a,b)=>a+b)/200;
                document.getElementById('ma120').innerText = `$${Math.floor(ma120)}`;
                document.getElementById('ma200').innerText = `$${Math.floor(ma200)}`;

                // 2.4 è®¡ç®— RSI
                let gains = 0, losses = 0;
                for(let i=prices.length-14; i<prices.length; i++) {
                    let diff = prices[i] - prices[i-1];
                    if(diff > 0) gains += diff; else losses += Math.abs(diff);
                }
                let rs = (gains/14) / (losses/14); // ç®€åŒ–ç‰ˆ SMA ç®—æ³•
                let rsi = 100 - (100 / (1 + rs));
                
                const rsiEl = document.getElementById('rsi');
                rsiEl.innerText = rsi.toFixed(1);
                // RSI < 30 è¶…å–(ç»¿), > 70 è¶…ä¹°(çº¢)
                if(rsi < 30) rsiEl.className = "text-xl font-bold text-green";
                else if(rsi > 70) rsiEl.className = "text-xl font-bold text-red";
                else rsiEl.className = "text-xl font-bold text-gray-300";

                // 2.5 æ ¸å¿ƒç®—æ³•ï¼šahr999
                const birth = new Date("2009-01-03").getTime();
                const now = new Date().getTime();
                const days = (now - birth) / 86400000;
                // æ‹Ÿåˆå¸ä»·å…¬å¼
                const fitPrice = Math.pow(10, 5.84 * Math.log10(days) - 17.01);
                
                const ahr999 = (currentPrice / fitPrice) * (currentPrice / ma200);
                
                const ahrValEl = document.getElementById('ahr-val');
                const ahrBadgeEl = document.getElementById('ahr-badge');
                
                ahrValEl.innerText = ahr999.toFixed(3);
                
                if (ahr999 < 0.45) {
                    ahrValEl.className = "text-6xl font-black text-green tracking-tighter";
                    ahrBadgeEl.innerText = "ğŸ”¥ æåº¦ä½ä¼°ï¼šæŠ„åº• (Buy)";
                    ahrBadgeEl.className = "text-xl font-bold px-6 py-2 rounded-full bg-green text-green border border-green-500/30";
                } else if (ahr999 < 1.2) {
                    ahrValEl.className = "text-6xl font-black text-blue tracking-tighter";
                    ahrBadgeEl.innerText = "ğŸ’ å®šæŠ•åŒºé—´ï¼šç§¯ç´¯ (DCA)";
                    ahrBadgeEl.className = "text-xl font-bold px-6 py-2 rounded-full bg-blue text-blue border border-blue-500/30";
                } else {
                    ahrValEl.className = "text-6xl font-black text-red tracking-tighter";
                    ahrBadgeEl.innerText = "ğŸš€ æ­¤æ—¶ä¸ä¹°ï¼šç­‰å¾… (Wait)";
                    ahrBadgeEl.className = "text-xl font-bold px-6 py-2 rounded-full bg-red text-red border border-red-500/30";
                }

            } catch (e) {
                console.error("Market Data Error:", e);
            }
        }

        // === 3. å‡åŠå€’è®¡æ—¶ ===
        function updateHalving() {
            const nextHalving = new Date("2028-04-15").getTime(); // é¢„ä¼°æ—¥æœŸ
            const now = new Date().getTime();
            const days = Math.floor((nextHalving - now) / 86400000);
            document.getElementById('halving').innerText = `${days} å¤©`;
        }

        // === å¯åŠ¨å¼•æ“ ===
        fetchFnG();
        fetchMarket();
        updateHalving();

        // è®¾ç½®è‡ªåŠ¨åˆ·æ–°ï¼šæ¯ 60 ç§’ä¸€æ¬¡
        setInterval(() => {
            fetchFnG();
            fetchMarket();
        }, 60000);

    </script>
</body>
</html>
